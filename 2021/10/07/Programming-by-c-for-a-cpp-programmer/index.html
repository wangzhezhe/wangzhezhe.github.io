<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Programming by c for a cpp programmer | AverageMind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This article try to describe some differences between the c and cpp from the programming perspective.">
<meta property="og:type" content="article">
<meta property="og:title" content="Programming by c for a cpp programmer">
<meta property="og:url" content="http://yoursite.com/2021/10/07/Programming-by-c-for-a-cpp-programmer/index.html">
<meta property="og:site_name" content="AverageMind">
<meta property="og:description" content="This article try to describe some differences between the c and cpp from the programming perspective.">
<meta property="og:locale">
<meta property="article:published_time" content="2021-10-07T22:02:03.000Z">
<meta property="article:modified_time" content="2021-10-08T01:50:51.000Z">
<meta property="article:author" content="zhe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="AverageMind" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-165927341-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
<!-- Google adds -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5642436380582343"
     crossorigin="anonymous">
</script>
<!-- End Google adds -->




<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AverageMind</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Programming-by-c-for-a-cpp-programmer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/07/Programming-by-c-for-a-cpp-programmer/" class="article-date">
  <time datetime="2021-10-07T22:02:03.000Z" itemprop="datePublished">2021-10-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/c-c/">c/c++</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Programming by c for a cpp programmer
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>This article try to describe some differences between the c and cpp from the programming perspective.</p>
<span id="more"></span>

<h3 id="No-stl"><a href="#No-stl" class="headerlink" title="No stl"></a>No stl</h3><p>you could not use the vector and map conveniently, which means you need to make hash map and linked list by yourself or use some third part libraries. There are some details here, such as the next pointer, some knowledge about using linked list coreaccltly, it sounds easy since it is the knowledge discussed at the text book, but it is hard to make everything right at one time.</p>
<p>One popular linked list in c is the lined list used by linux, there are all kinds of related resource online. Another one is this <a target="_blank" rel="noopener" href="https://troydhanson.github.io/uthash/">uthash</a>.</p>
<p>Recently, there is a cpp project, and I need to adapt it to the c version, one complexity part is to update the vector that contains a list of addresses. We need to consider more in c version. The typical struct can include two parts, the first one can be a integer that signify the size of the object, and then second one is a raw pointer that contains the actual data. It is quite general, the char pointer can contains all kinds of data. But it also increase the complaxity to manage differnet things. When I use the vector string, I do not need to care too much about the size of string, but for c version, we need to set them explicitly, such as specifying that there are 256 byte for each string and split the whole banch of memory into different partitions manually. In that case, I need to use a lot memcpy things when extract every string, which increases the programming complexity.</p>
<p>In fact, you could always ask your self, whhy not use the stl. I remember at one class for the graduate study, I use the c to finish project (I was not familir with the cpp at that time). Then it consumes me a lot of time to debug the list implementaiton which can be processed by cpp conveniently actually.</p>
<p>Since we need to process string manaully, the temination of the string may become important, such as distinction between null, <code>\0</code> and 0. how we init the memory to make every details correct. refer to <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1296843/what-is-the-difference-between-null-0-and-0">this</a>. how to explain the 0 in different cases. When we set the charater as 0 or <code>\0</code>, we set the to int zero in memory actually. When we set the ‘0’, it is actually an char that represent the 0 which is the ascii code of character 0, the memory value is not 0, it is 48, which is the ascii value of 0.</p>
<h3 id="Compiling-c-and-cpp-name-mangling"><a href="#Compiling-c-and-cpp-name-mangling" class="headerlink" title="Compiling c and cpp, name mangling"></a>Compiling c and cpp, name mangling</h3><p>When you compile the c with cpp, try to consider that your program may be called by the c program. Becasue the name mangling, we may use this in the header file of the cpp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#if defined(__cplusplus)</span><br><span class="line">extern &quot;C&quot; &#123;</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">#if defined(__cplusplus)</span><br><span class="line">&#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>

<p>The defination of the function shoule be in c style, and the implementation of them can be in the cpp style. By this way, this header file can be used both by c and cpp program.</p>
<h3 id="No-reference-only-pointer"><a href="#No-reference-only-pointer" class="headerlink" title="No reference, only pointer"></a>No reference, only pointer</h3><p>In the c world, the <code>*</code> and the <code>**</code> can be the common one for memory allocation management and the data transfer. For the cpp word, the lvalue reference <code>&amp;</code> and the rvalue reference <code>&amp;&amp;</code> can be common case for data transfer in function call.<br>Sometimes, we tend to use the <code>typedef struct</code> to define a pointer such as <code>typedef struct margo_instance* margo_instance_id</code>, then we can avoid some complex expression such as <code>**</code>.</p>
<p>Here are some <a target="_blank" rel="noopener" href="https://yarchive.net/comp/linux/typedefs.html">interesting discussion</a> about the typedef and the struct</p>
<h3 id="Buffered-output"><a href="#Buffered-output" class="headerlink" title="Buffered output"></a>Buffered output</h3><p>In cpp, there are no issue when you use cout to output sth and write them into the log. In c, we need to use the fflush in order to output what we want. Sometimes, we just ust the stderr to replace the stdout since it is unbuffered, check <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/3723795/is-stdout-line-buffered-unbuffered-or-indeterminate-by-default">this</a>.</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/20267244/why-fprintf-doesnt-write-directly-into-the-file-unless-fflush-is-used">https://stackoverflow.com/questions/20267244/why-fprintf-doesnt-write-directly-into-the-file-unless-fflush-is-used</a></p>
<p><a target="_blank" rel="noopener" href="https://c-for-dummies.com/blog/?p=3675">https://c-for-dummies.com/blog/?p=3675</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/07/Programming-by-c-for-a-cpp-programmer/" data-id="clt2e6ye900366zjrhtl97wwf" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
    <a href="/2021/10/15/Reading-Story-Being-logical/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Reading-Story (Being logical)
        
      </div>
    </a>
  
  
    <a href="/2021/07/23/Poem-Story/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Poem Story</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#No-stl"><span class="toc-number">1.</span> <span class="toc-text">No stl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compiling-c-and-cpp-name-mangling"><span class="toc-number">2.</span> <span class="toc-text">Compiling c and cpp, name mangling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#No-reference-only-pointer"><span class="toc-number">3.</span> <span class="toc-text">No reference, only pointer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Buffered-output"><span class="toc-number">4.</span> <span class="toc-text">Buffered output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">5.</span> <span class="toc-text">References</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2024 zhe&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;godenwangzhe@gmail.com
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  



 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>