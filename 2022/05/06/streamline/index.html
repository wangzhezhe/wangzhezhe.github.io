<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Streamline filter | AverageMind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This article discusses the vtk stream line filter and how it is implemented.">
<meta property="og:type" content="article">
<meta property="og:title" content="Streamline filter">
<meta property="og:url" content="http://yoursite.com/2022/05/06/streamline/index.html">
<meta property="og:site_name" content="AverageMind">
<meta property="og:description" content="This article discusses the vtk stream line filter and how it is implemented.">
<meta property="og:locale">
<meta property="article:published_time" content="2022-05-07T02:38:24.000Z">
<meta property="article:modified_time" content="2022-05-09T14:56:32.000Z">
<meta property="article:author" content="zhe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="AverageMind" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-165927341-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AverageMind</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-streamline" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/05/06/streamline/" class="article-date">
  <time datetime="2022-05-07T02:38:24.000Z" itemprop="datePublished">2022-05-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Visualization/">Visualization</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Streamline filter
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>This article discusses the vtk stream line filter and how it is implemented.</p>
<span id="more"></span>

<h3 id="General-idea-of-the-streamline-algorithm"><a href="#General-idea-of-the-streamline-algorithm" class="headerlink" title="General idea of the streamline algorithm"></a>General idea of the streamline algorithm</h3><p>Assuming there is vector field in space, and we want to visualize it, we might put a point (fluid element) in it (seed), then that point will move among the space because of the existance of the vector field. We might trace the trajectory of that particle to see how it moves with the increase of the timestep. This line is called the streamline.</p>
<p>The formal defination of streamline: refer to this video: <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8MUPQbazkLQ">https://www.youtube.com/watch?v=8MUPQbazkLQ</a>. </p>
<p>Streamlines are lines that are tangent to the velocity field.</p>
<p>More formal and detailed description can be found <a target="_blank" rel="noopener" href="https://kitware.github.io/vtk-examples/site/VTKBook/06Chapter6/#streamlines">here</a>. The caculation of the streamline is the integration of the vector field based with the increase of the time step (this can be a small segment). If we combines multiple segments together, we can get a final streamline which across multiple step.</p>
<p>Other relates concepts: vector field reconstruction. Refer to this work (Vector field reconstruction from sparse samples with applications). The input is a set of sample point with the vector, the output is an image with different color that shows the vector field in the whole domain.</p>
<p>There are some realted works that use the ML techniques to do this (<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=sz_MbjftQTQ">https://www.youtube.com/watch?v=sz_MbjftQTQ</a>), such as SVM or deep learning things. <strong>Given the sparse set of particles in the vector field, the goal is to create a function that approximate the vector field over the domain</strong> When we say the reconstruction, we want to reconstruct that function from the sample particles. The video mentioned above provides a good explanation.</p>
<h3 id="The-streamline-example-in-paraview"><a href="#The-streamline-example-in-paraview" class="headerlink" title="The streamline example in paraview"></a>The streamline example in paraview</h3><p>There are two examples on vtk-example about the streamline, one is this (<a target="_blank" rel="noopener" href="https://kitware.github.io/vtk-examples/site/Python/Visualization/StreamLines/">https://kitware.github.io/vtk-examples/site/Python/Visualization/StreamLines/</a>) another is this (<a target="_blank" rel="noopener" href="https://kitware.github.io/vtk-examples/site/Cxx/Visualization/Kitchen/">https://kitware.github.io/vtk-examples/site/Cxx/Visualization/Kitchen/</a>).</p>
<p>The associated data can be found here (<a target="_blank" rel="noopener" href="https://github.com/lorensen/VTKExamples/tree/master/src/Testing/Data/">https://github.com/lorensen/VTKExamples/tree/master/src/Testing/Data/</a>)</p>
<p>We first show how to load these data into the paraview and show the results of using the stream line in it.</p>
<p>The first example is the <code>combxyz.bin</code> and the <code>combq.bin</code> case. Thi data format is called the PLOT3D. In the Paraview, we first load the <code>combxyz.xyz</code> using the PLOT3D file fomat, and then click the Q file name at the properties section to load all the data. (A typical plot3d data contains the q file and the xyz file). Then the file can be loaded successfully. For the kitchen.vtk example, the data is in vtk format, and we just need to load it direactly into the vtk.</p>
<p>After that, just click the streamline trace filter and we can know the streamline. At the information section of the paraview, we can see the type of the streamline is the polygonal mesh. The color of the streamline in paraview can also change with when we use different variables. </p>
<p>By clicking the gear button at the properties section, we can show all the settings of the associated filter. We can adjust the control the seed, the number of steps and the granularity of step (length of step) etc.</p>
<p>This is another good tutorial (<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=1jml3j3BmUg">https://www.youtube.com/watch?v=1jml3j3BmUg</a>) about how to use the streamline for paraview, we can use the tube filter and glyph graph to show the direaction of the streamline.  </p>
<h3 id="Using-the-stream-line-in-VTK-code"><a href="#Using-the-stream-line-in-VTK-code" class="headerlink" title="Using the stream line in VTK code"></a>Using the stream line in VTK code</h3><p>This is one example code (<a target="_blank" rel="noopener" href="https://github.com/wangzhezhe/5MCST/blob/master/vtk_example/streamline/streamline_example1.cpp">https://github.com/wangzhezhe/5MCST/blob/master/vtk_example/streamline/streamline_example1.cpp</a>) about the streamline based on VTK in cpp code</p>
<p>It use the plane as a source, then setting necessary variables such as propagation steps and the integration step. After that, it writes the resutls into the disk</p>
<p>This is the another example that use the kitchen.vtk data (<a target="_blank" rel="noopener" href="https://github.com/wangzhezhe/5MCST/blob/master/vtk_example/streamline/streamline_exampleKitchen.cpp">https://github.com/wangzhezhe/5MCST/blob/master/vtk_example/streamline/streamline_exampleKitchen.cpp</a>) The seed source is a line in this case.</p>
<p>We can load these generated data into the paraview and do the further analysis. Then we dive into more details to see how the stream trace filter is implemented in VTK.</p>
<h3 id="Understanding-the-how-VTK-implement-the-stream-line-filter"><a href="#Understanding-the-how-VTK-implement-the-stream-line-filter" class="headerlink" title="Understanding the how VTK implement the stream line filter"></a>Understanding the how VTK implement the stream line filter</h3><p>It is not easy to understand all the details about how the VTK implement the stream tracer. We only take some key steps here.</p>
<p>The assocaited filter <code>vtkStreamTracer.h</code> or <code>vtkStreamTracer.cxx</code> is located at <code>VTK/Filters/FlowPaths</code> in the vtk repo, there is also <code>vtkGenericStreamTracer</code> in the <code>VTK/Generic</code> repo and it looks that the code are similar. </p>
<p>The start point of the <code>vtkStreamTracer</code> filter is <code>vtkStreamTracer::Integrate</code> after all kinds of data pre processing. The core operation is integration operation use the Runge-Kutta method. <code>integrator-&gt;ComputeNextStep</code>. The point2 is the next step, then update the point1 and use the new computed point2 to update the code gradually. The readme of that function can show lots of details, here are some common parameters: seeds is the start point, we could assume we put an particle at this position, the steps indicates how many step we want to go, and then we move that imaginary particle along the current field to see how it moves. That is the key idead of the stream line. We can specify more specific parameters such as the step size or the granularity of the step. In paraview, click the gear button at the left side, it shows all parameters and their default settings used by associated filter.</p>
<p><strong>Some idea about the runge-kutta method</strong></p>
<p>These are several useful materials:</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=IYyECJmxfG0">https://www.youtube.com/watch?v=IYyECJmxfG0</a></p>
<p>The code example that solves the real problem<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=1FYrnwqWQNY">https://www.youtube.com/watch?v=1FYrnwqWQNY</a></p>
<p>This is a good theoretical explanation:<br><a target="_blank" rel="noopener" href="https://lpsa.swarthmore.edu/NumInt/NumIntSecond.html">https://lpsa.swarthmore.edu/NumInt/NumIntSecond.html</a></p>
<p>On the online tutorial such as wiki page, they always provide a basic form which is the 1d situation. The actual code ususlly focuse on 2d or 3d cases. Instead of using x, y, z … The actucal code ususlly use a vector of x to represents the input indepedent variables. If we understanding naively for runge-kutta method, it just tries to estimate a proper k at the tangential direction to compute the next point value. The higher order method has a more accurate results.</p>
<p>Another key point is that, in the tutorial, we always have a concrete function at the right side as an example, we know the function form. But for the numerical case, such as streamline case, we do not have that function and we just have a set of points and each points has a 3d coordinates and associated scalar or vector values. In the VTK, there is FunctionValues associated with each function, it compute the value of x for the function f. x and f are two parameters of the FunctionValues. In the streamline case, it uses the <code>vtkInterpolatedVelocityField</code>, which can compute the function value based on the data sets. According to the VTK <a target="_blank" rel="noopener" href="https://kitware.github.io/vtk-examples/site/VTKBook/06Chapter6/#streamlines">text book</a>, the change rate of stream line trajactory within specific delt t is the vector field. </p>
<p>For example, <code>VTK/Common/Math/vtkRuneKutta2.h</code> provides necessary function for the RungeKutta2.</p>
<p>xprev is the previous data<br>xnext is the next step data<br>t is the current time<br>delT is the time slice</p>
<p><code>vtkFunctionSet</code> specifies an abstract interface for set of functions<br>of the form F_i &#x3D; F_i(x_j) where F (with i&#x3D;1..m) are the functions<br>and x (with j&#x3D;1..n) are the independent variables.</p>
<p>The this-&gt;Derivs is updated gradually, it first represents the k1 then represents the k2. FunctionValues compute the value at the next point (t+h&#x2F;2)</p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a target="_blank" rel="noopener" href="https://kitware.github.io/vtk-examples/site/VTKBook/06Chapter6/#63-vector-algorithms">https://kitware.github.io/vtk-examples/site/VTKBook/06Chapter6/#63-vector-algorithms</a></p>
<p>pipeline of the scientific vis</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/researchsummer/visualization-of-a-vector-field-9402615c780a">https://medium.com/researchsummer/visualization-of-a-vector-field-9402615c780a</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2022/05/06/streamline/" data-id="cl4a104ix006s89mc71xx6s4j" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
  
    <a href="/2022/04/26/cpptemplateCRPT/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Cpp template about CRPT</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#General-idea-of-the-streamline-algorithm"><span class="toc-number">1.</span> <span class="toc-text">General idea of the streamline algorithm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-streamline-example-in-paraview"><span class="toc-number">2.</span> <span class="toc-text">The streamline example in paraview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-the-stream-line-in-VTK-code"><span class="toc-number">3.</span> <span class="toc-text">Using the stream line in VTK code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Understanding-the-how-VTK-implement-the-stream-line-filter"><span class="toc-number">4.</span> <span class="toc-text">Understanding the how VTK implement the stream line filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">5.</span> <span class="toc-text">References</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2022 zhe&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;godenwangzhe@gmail.com
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  



 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>