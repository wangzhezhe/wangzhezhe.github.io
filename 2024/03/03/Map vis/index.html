<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Map vis | AverageMind</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Some tips about map visuliazation">
<meta property="og:type" content="article">
<meta property="og:title" content="Map vis">
<meta property="og:url" content="http://yoursite.com/2024/03/03/Map%20vis/index.html">
<meta property="og:site_name" content="AverageMind">
<meta property="og:description" content="Some tips about map visuliazation">
<meta property="og:locale">
<meta property="article:published_time" content="2024-03-03T09:12:10.000Z">
<meta property="article:modified_time" content="2024-04-20T21:12:33.902Z">
<meta property="article:author" content="zhe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="AverageMind" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-165927341-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
<!-- Google adds -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5642436380582343"
     crossorigin="anonymous">
</script>
<!-- End Google adds -->




<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AverageMind</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Map vis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2024/03/03/Map%20vis/" class="article-date">
  <time datetime="2024-03-03T09:12:10.000Z" itemprop="datePublished">2024-03-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Visualization/">Visualization</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Map vis
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <p>Some tips about map visuliazation</p>
<span id="more"></span>


<h3 id="Preparing-env"><a href="#Preparing-env" class="headerlink" title="Preparing env"></a>Preparing env</h3><p>Originally, I’m considering using Flask as backend, but i’m not developing a web app, and I do not have a ip and server to hold my service. I’m actually working on a desktop service. The dedicated user is not public (I do not need to consider the account, session things for different user). The goal of that project is just provide a GUI to let user input something, store in the local file in an organized way, index&#x2F;search the data as needed, and draw out the searched results.</p>
<p>Final thought, using pyqt as the backend and using d3 for rendering map specified by geo json file.</p>
<h3 id="Associated-web-knowledge"><a href="#Associated-web-knowledge" class="headerlink" title="Associated web knowledge"></a>Associated web knowledge</h3><p>In html, using svg tag to specify the position of the map</p>
<p>the js file can be included in the header of body section of the html. the js file is separated functions to be executed each time we need to render resutls.</p>
<p>pyqt webengine can be viewed as a browser, but it is not flexible as actual browser(no interactive debug consol for js), the good thing is to debug the html well through general browser, when it is ready, then embed it into the pyat.</p>
<h3 id="svg-properties"><a href="#svg-properties" class="headerlink" title="svg properties"></a>svg properties</h3><p>append(“g”) group several elements together</p>
<p>A trick part to vis multiple feature blocks sometimes. Originally, I set <code>.attr(&quot;fill&quot;, &quot;white&quot;)</code> but it turns out that for each filter, this fill is applied to the whole object once. The result can not be shown properly. Even if I use <code>style(&quot;opacity&quot;,0.1)</code>, the feature blog that is vised firstly has been covered by multiple layers and the results are getting blur, the newly rendered feature reagion is clear. I stucked there for a long time and the issue is solved after I set <code>attr(&quot;fill&quot;,&quot;none&quot;)</code>.</p>
<p>&#x2F;&#x2F; select all SVG path elements in document order<br>d3.selectAll(“path”);</p>
<p>TODO, the coresponding relationship between the svg tag and the svg variable in js</p>
<p>TODO <code>=&gt;</code> in js</p>
<p>TODO, the fill for the path did not fill the inner region of the map in multiPolygon, it seems that it will fill background each time for each province. Some province is clear, some are not, the province drawn eariler are clear, so I set fill as empty</p>
<p>TODO draw the circle and polygon separately can put fill the region correctly.</p>
<h3 id="d3-api"><a href="#d3-api" class="headerlink" title="d3 api"></a>d3 api</h3><p>d3. select means to select specific html tag. </p>
<h3 id="geojson-how-to-create-projection"><a href="#geojson-how-to-create-projection" class="headerlink" title="geojson how to create projection"></a>geojson how to create projection</h3><p>project the geo coordinates into the 2d coordinates.</p>
<h3 id="Interactive-tool-for-choosing-geo-region"><a href="#Interactive-tool-for-choosing-geo-region" class="headerlink" title="Interactive tool for choosing geo region"></a>Interactive tool for choosing geo region</h3><p>Sometimes, we want to interactively selecting a specific region on the map, here is a good tool to help us to do that:</p>
<p>Interactive geo based API tool:</p>
<p><a target="_blank" rel="noopener" href="https://www.birdtheme.org/useful/v3tool.html">https://www.birdtheme.org/useful/v3tool.html</a></p>
<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p>good explanation about d3, geo and assocaited background knowledge, good explanatino of <code>d3.geoPath().projection</code></p>
<p><a target="_blank" rel="noopener" href="https://www.sohamkamani.com/javascript/d3-geo-projections/">https://www.sohamkamani.com/javascript/d3-geo-projections/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2024/03/03/Map%20vis/" data-id="cm2a0xf49002xdvjrg85b4y0d" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
    <a href="/2024/03/31/All-aspects-of-optimization-techniques/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          All aspects of optimization techniques
        
      </div>
    </a>
  
  
    <a href="/2024/03/03/Hard-research-questions/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Hard research questions</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Preparing-env"><span class="toc-number">1.</span> <span class="toc-text">Preparing env</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Associated-web-knowledge"><span class="toc-number">2.</span> <span class="toc-text">Associated web knowledge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#svg-properties"><span class="toc-number">3.</span> <span class="toc-text">svg properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d3-api"><span class="toc-number">4.</span> <span class="toc-text">d3 api</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#geojson-how-to-create-projection"><span class="toc-number">5.</span> <span class="toc-text">geojson how to create projection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Interactive-tool-for-choosing-geo-region"><span class="toc-number">6.</span> <span class="toc-text">Interactive tool for choosing geo region</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">7.</span> <span class="toc-text">References</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2024 zhe&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;godenwangzhe@gmail.com
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  



 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>